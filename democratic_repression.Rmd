---
title: "Democratic Repression: Responding in Kind?"
author: "Christopher Junk"
date: "May 9, 2019"
output: 
  pdf_document:
    citation_package: natbib
    template: svm-latex-ms2.tex 
bibliography: \dummy{`r file.path(getwd(), list.files(getwd(), "bib$"))`}
biblio-style: apsr
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(lubridate)
```

```{r speed_read, include = F, cache=T}
#Load in the dataset
speed_full <- read.csv("../Data/speed/ssp_public.csv")
speed_full <- as_tibble(speed_full) %>% 
              janitor::clean_names()
```

```{r country_codes, include=F, cache=T}
#add country codes
speed_full$country
speed_full <- speed_full %>% 
  mutate(cowcode = countrycode::countrycode(country, "country.name", "cown"),
         cowname = countrycode::countrycode(cowcode, "cown", "cowc"),
         start_date = as.Date(jul_start_date, origin = "1944-12-31"), #make the starting date formatted in readable way
         end_date = as.Date(jul_end_date, origin = "1944-12-31")) %>% #make the ending date formatted in a readable way 
         select(year, month, day, start_date, end_date, day_span, everything())
```

```{r speed_dates, include = F, cache = T}
#Delete missing months 
speed_nonmissing_date <- speed_full %>% 
                         filter(!is.na(start_date),
                                !is.na(end_date), #remove those without starting or ending dates -- only 67 observations  
                                !is.na(cowcode)) %>%  #remove missing values for identifying a country. These would not fit into country-month unit of analysis. 
                         select(everything())

                          
#Ultimately my analyses will be in country-month units so I need to generate a year-month variable to group on later. I also need to have a year-month format for both start and end dates, because I have events that span several months. I will later assume the an event is equally active across all months it is active because I ultimately use a binary DV and that assumption is therefore not impactful. I care, therefore, IF an event occurred in a given month, not about its intensity. 

speed_nonmissing_date$start_ym <- stringr::str_replace(as.character(speed_nonmissing_date$start_date), "\\-\\d{2}$", "")
#speed_nonmissing_date$start_ym #this is a string for the year-month of the start of an event

speed_nonmissing_date$start_year_month <- zoo::as.yearmon(speed_nonmissing_date$start_ym) #this is a yearmon class variable of the string above


speed_nonmissing_date$end_ym <- stringr::str_replace(as.character(speed_nonmissing_date$end_date), "\\-\\d{2}$", "")

speed_nonmissing_date$end_year_month <- zoo::as.yearmon(speed_nonmissing_date$end_ym) #class yearmon of zoo 

speed_nonmissing_date$start_month <- month(speed_nonmissing_date$start_date) #extract start month from start date

speed_nonmissing_date$start_year <- year(speed_nonmissing_date$start_date) #extract start year from start date

speed_nonmissing_date$end_month <- month(speed_nonmissing_date$end_date) #extract end month from end date 

speed_nonmissing_date$end_year <- year(speed_nonmissing_date$end_date) #extract end year from end date 

#create a duration in months 
speed_nonmissing_date$duration <- ((speed_nonmissing_date$end_year_month - speed_nonmissing_date$start_year_month) *12) + 1 #If you just subtract the dates then it gives it to you as a function of a year, each month being 1/12th of a year. Multiplying it by 12 gives me the number of months, and add one because a minimum duration is the 1 month that it existed. 
```
  
```{r speed_expand, include=F, cache = T}
#The variables that I care about are the following:  

  # start_year_month: year-month variable for start of event  
  # end_year_month: year-month variable for end of event  
  # duration: number of months between start and end  
  # cowcode: COW country codes  
  # country: country text  
  # pol_express: symbolic expression  
  # mass_express: mass protests  
  # pol_viol: political violence  
  # intang_rep: intangible repression  
  # st_repress: tangible repression  
  # stat_viol: violent repression

#grab the relevant variables for this analysis 
speed_relevant <- speed_nonmissing_date %>% 
                  select(start_year_month, 
                         end_year_month, 
                         eventid, 
                         duration, 
                         cowcode, 
                         country, 
                         cowname, 
                         pol_express, 
                         mass_express, 
                         pol_viol, 
                         intang_rep, 
                         st_repress, 
                         stat_viol
                         )

speed_relevant_expand <- reshape::untable(speed_relevant, num = speed_relevant$duration)

speed_relevant_expand <- speed_relevant_expand %>% 
                         group_by(eventid) %>% 
                         mutate(seq = seq_along(duration), #a count of how many months the event lasts
                                month_increment = seq/12, #the count divided by 12
                                mdate = (start_year_month - 1/12) + month_increment #monthly date for each month an event was active
                                ) %>% 
                         select(seq, 
                                duration, 
                                eventid, 
                                month_increment, 
                                mdate, 
                                start_year_month, 
                                end_year_month,  
                                everything())

speed_relevant_expand$year_month <- zoo::as.yearmon(speed_relevant_expand$mdate)


speed_country_month <- speed_relevant_expand %>% 
                        group_by(cowcode, year_month) %>% 
                        summarize(mean(pol_express),
                                  mean(mass_express),
                                  mean(pol_viol),
                                  mean(intang_rep),
                                  mean(st_repress),
                                  mean(stat_viol), 
                                  first(cowname)) %>% 
                        arrange(cowcode, year_month) %>% 
                        janitor::clean_names() %>% 
                        ungroup()

#the final object of the speed data is ready: speed_country_month
```

```{r system_setup, include = F, cache = T}
#This chunk generates the controls and merges the final dataframe together 

#First, I need to get my universe of possible cases. I start with Correlates of War systemic membership dataset because it has all possible country-years available. 
country_entry <- read.csv("http://www.correlatesofwar.org/data-sets/state-system-membership/states2016/at_download/file")

country_duration <- country_entry %>% 
                 mutate(enter_date = paste0(styear, "-", stmonth), #country started
                        leave_date = paste0(endyear, "-", endmonth), #country ended
                        enter = zoo::as.yearmon(enter_date), #as zoo class
                        leave = zoo::as.yearmon(leave_date)  #as zoo class
                        ) %>%
                 select(cowcode = ccode, #renaming relevant variables 
                        cowname = stateabb, 
                        enter, 
                        leave
                        )

country_duration <- country_duration %>% 
                    mutate(duration = ((leave - enter) * 12 ) + 1 #number of months a country existed
                           ) 

country_expand <- reshape::untable(country_duration, num = country_duration$duration) #expand to create one row for each month a country existed
                 
country_month <- country_expand %>% 
                 group_by(cowcode) %>% 
                 mutate(seq = seq_along(duration), #count of months country existed
                        month_increment = seq/12, #the count divided by 12
                        mdate = (enter - 1/12) + month_increment #unformatted zoo yearmon object
                        ) %>%   
                 ungroup()

country_month$year_month <- zoo::as.yearmon(country_month$mdate) #format the yearmon object 

system_month <- country_month %>% 
                select(cowcode,
                       cowname,
                       year_month) %>% #final dataframe of all possible country_months
                filter(year_month >= "Jan 1944") #speed data starts after 1944
```

```{r intrastate_control, include=F, cache = T}
intrastate <- read.csv("http://www.correlatesofwar.org/data-sets/COW-war/intra-state-war-data-v4-1/at_download/file") %>% 
              janitor::clean_names()

intrastate <- intrastate %>% 
               mutate(start_year1 = ifelse(start_year1 < 0, NA, start_year1),
                      start_month1 = ifelse(start_month1 < 0, NA, start_month1),
                      start_year2 = ifelse(start_year2 < 0, NA, start_year2),
                      start_month2 = ifelse(start_month2 < 0, NA, start_month2),
                      end_year1 = ifelse(end_year1 < 0, NA, end_year1),
                      end_month1 = ifelse(end_month1 < 0, NA, end_month1),
                      end_year2 = ifelse(end_year2 < 0, NA, end_year2),
                      end_month2 = ifelse(end_month2 < 0, NA, end_month2))

intrastate <- intrastate %>% 
              mutate(ccode = ifelse(ccode_a > 0, ccode_a, ccode_b), #one country code for each intrastate war
                     cowcode = ifelse(ccode > 0, ccode, NA), #no countries were belligerents if there is not a cowcode
                     start1 = paste0(start_year1, "-", start_month1), #first start yearmonth
                     end1 = paste0(end_year1, "-", end_month1), #first end yearmonth
                     start2 = paste0(start_year2, "-", start_month2),
                     end2 = paste0(end_year2, "-", end_month2)
                     ) %>% 
              select(ccode_a, ccode_b, cowcode, start1, end1, start2, end2, everything()
                     ) %>% 
              arrange(war_num)


intrastate <- intrastate %>% 
              mutate(start1 = ifelse(stringr::str_detect(start1, pattern = "NA"), paste0(start_year1, "-", 12), start1),
                     
                     start2 =ifelse(stringr::str_detect(start2, pattern = "NA"), paste0(start_year2, "-", 12), start2),
                     
                     end1 = ifelse(stringr::str_detect(end1, pattern = "NA"), paste0(2016, "-", 12), end1),
                     
                     end2 = ifelse(stringr::str_detect(end2, pattern = "NA"), paste0(2016, "-", 12), end2)
              )

intrastate$start_ym1 <- zoo::as.yearmon(intrastate$start1)
intrastate$start_ym2 <- zoo::as.yearmon(intrastate$start2)
intrastate$end_ym1 <- zoo::as.yearmon(intrastate$end1)
intrastate$end_ym2 <- zoo::as.yearmon(intrastate$end2)

intrastate <- intrastate %>% 
              filter(start_ym1 > "Jan 1944") %>% 
              mutate(intrastate = 1,
                     duration1 = ((end_ym1 - start_ym1) * 12) + 1,
                     duration2 = ((end_ym2 - start_ym2) * 12) + 1,
                     two_start = ifelse(!is.na(start_ym1 & start_ym2), 2, 1)
                     ) %>% 
              select(cowcode, start_ym1, end_ym1, duration1, start_ym2, end_ym2, duration2, two_start, war_num, intrastate)

intrastate_two_start <- uncount(intrastate, two_start, .remove = F) %>% 
                        as_tibble()

intrastate_pre_expand <- intrastate_two_start %>% 
              group_by(war_num, cowcode) %>% 
              mutate(seq = seq_along(two_start),
                     start = ifelse(seq == 1, start_ym1, start_ym2),
                     end = ifelse(seq == 1, end_ym1, end_ym2),
                     duration1_final = ifelse(seq == 1, duration1, 1),
                     duration2 = ifelse(is.na(duration2), 1, duration2),
                     duration2_final = ifelse(seq == 2, duration2, 1),
                     id = paste0(cowcode, "_", war_num, "_", seq)) %>% 
              filter(seq < 3) %>% 
              ungroup() %>% 
              as_tibble()
              

intrastate_expand_first <- intrastate_pre_expand %>% 
                           group_by(id) %>% 
                           uncount(round(duration1_final, 0), .remove = F) %>% #this uses the round function because the some of the numbers were '125.' instead of '125', for example. This created a problem, and round fixed it by removing the decimal. 
                           mutate(time1 = seq_along(duration1_final),
                                  correct1 = ifelse(round(max(time1), 0) == round(duration1_final, 0), 1, 0)) %>% 
                           select(id, duration1_final, seq, time1, everything()) %>% 
                           arrange(id) %>% 
                           ungroup() %>% 
                           as_tibble()

intrastate_expand <- intrastate_expand_first %>% 
                     group_by(id) %>% 
                     uncount(round(duration2_final, 0), .remove = F) %>% 
                     mutate(time2 = seq_along(duration2_final),
                            correct2 = ifelse(max(time2) == max(duration2_final), 1, 0)) %>% 
                     select(id, duration2_final, time2, duration1_final, time1, everything()) %>% 
                     arrange(id)
                     
intrastate_expand <- intrastate_expand %>% 
                     mutate(mdate1 = ifelse(seq == 1, (start_ym1 - 1/12) + time1/12, NA),
                            mdate2 = ifelse(seq == 2, (start_ym2 - 1/12) + time2/12, NA)) %>% 
                     select(id, mdate1, start_ym1, end_ym1, mdate2, start_ym2, end_ym2, seq, intrastate, everything())

intrastate_expand$year_month1 <- zoo::as.yearmon(intrastate_expand$mdate1)
intrastate_expand$year_month2 <- zoo::as.yearmon(intrastate_expand$mdate2)



intrastate_expand <- intrastate_expand %>% 
                     mutate(year_month = ifelse(!is.na(year_month1), year_month1, year_month2))
intrastate_expand$year_month <- zoo::as.yearmon(intrastate_expand$year_month)

intrastate_expand <- intrastate_expand %>% 
                     select(id, mdate1, mdate2, year_month, start_ym1, end_ym1, start_ym2, end_ym2, cowcode, intrastate)
                     
analysis_prep <- left_join(system_month, intrastate_expand) %>%
            select(cowcode, cowname, intrastate, year_month) %>% 
            mutate(intrastate = (ifelse(!is.na(intrastate), intrastate, 0)))
```

```{r interstate_control, include = F, cache = T}
interstate <- read.csv("http://correlatesofwar.org/data-sets/COW-war/inter-state-war-data/at_download/file") %>% 
              janitor::clean_names() %>% 
              mutate(cowcode = ccode, 
                     start_ym1 = ifelse(start_year1 > 0 & start_month1 > 0, 
                                        paste0(start_year1, "-", start_month1),
                                        NA),
                     start_ym2 = ifelse(start_year2 > 0 & start_month2 > 0, 
                                        paste0(start_year2, "-", start_month2),
                                        NA),
                     end_ym1 = ifelse(end_year1 > 0 & end_month1 > 0, 
                                        paste0(end_year1, "-", end_month1),
                                        NA), 
                     end_ym2 = ifelse(end_year2 > 0 & end_month2 > 0, 
                                        paste0(end_year2, "-", end_month2),
                                        NA), 
                     twostart = round(ifelse(!is.na(start_ym1) & !is.na(start_ym2), 
                                       2,
                                       1), 0)) %>% 
              select(cowcode, 
                     start_ym1, 
                     start_year1, 
                     start_month1, 
                     end_ym1, 
                     end_year1, 
                     end_month1,
                     start_ym2, 
                     start_year2, 
                     start_month2, 
                     end_ym2, 
                     end_year2, 
                     end_month2,
                     twostart,
                     everything())

#change the starting and ending year-month dates to yearmon 
interstate$start_ym1 <- zoo::as.yearmon(interstate$start_ym1)
interstate$start_ym2 <- zoo::as.yearmon(interstate$start_ym2)
interstate$end_ym1 <- zoo::as.yearmon(interstate$end_ym1)
interstate$end_ym2 <- zoo::as.yearmon(interstate$end_ym2)


interstate_twostart <- interstate %>% 
                       uncount(twostart, .remove = F) %>%
                       group_by(war_num, cowcode) %>% 
                       mutate(seq = seq_along(twostart),
                              id = paste0(cowcode, "_", war_num, "_", seq), 
                              duration1 = ((end_ym1 - start_ym1) * 12) + 1,
                              duration2 = ((end_ym2 - start_ym2) * 12) + 1, 
                              duration1_final = round(ifelse(seq == 1, 
                                                             duration1,
                                                             1), 
                                                      0),
                              duration2_final = round(ifelse(seq == 2, 
                                                             duration2, 
                                                             1), 
                                                      0),
                              duration2_final = ifelse(is.na(duration2_final), 
                                                       1, 
                                                       duration2_final)
                              ) %>% 
                       select(id,
                              duration1,
                              duration1_final,
                              duration2, 
                              duration2_final,
                              seq,
                              everything())

interstate_expand_first <- interstate_twostart %>% 
                           group_by(id) %>% 
                           uncount(duration1_final, .remove = F) %>% 
                           mutate(time1 = seq_along(duration1_final)) %>% 
                           select(id,
                                  time1,
                                  duration1_final,
                                  seq, 
                                  everything()) %>% 
                           ungroup()

interstate_expand <- interstate_expand_first %>% 
                     group_by(id) %>% 
                     uncount(duration2_final, .remove = F) %>% 
                     mutate(time2 = seq_along(duration2_final),
                            time = ifelse(seq == 1, time1, time2), 
                            start_ym = ifelse(seq == 1, 
                                              start_ym1, 
                                              start_ym2),
                            end_ym = ifelse(seq == 1, 
                                            end_ym1,
                                            end_ym2),
                            mdate = (start_ym - 1/12) + time/12) %>% 
                     ungroup() %>% 
                     select(id, 
                            time1, 
                            duration1_final, 
                            time2, 
                            duration2_final, 
                            time, 
                            seq,
                            start_ym, 
                            mdate,
                            end_ym,
                            start_ym1,
                            end_ym1, 
                            start_ym2, 
                            end_ym2,
                            everything())

interstate_expand$start_ym <- zoo::as.yearmon(interstate_expand$start_ym)
interstate_expand$end_ym <- zoo::as.yearmon(interstate_expand$end_ym)
interstate_expand$year_month <- zoo::as.yearmon(interstate_expand$mdate)

interstate_final <- interstate_expand %>% 
                    mutate(interstate = 1) %>% 
                    filter(year_month >= "Jan 1944") %>% 
                    select(cowcode, year_month, interstate)

analysis_prep <- left_join(analysis_prep, interstate_final) %>% 
            mutate(interstate = ifelse(!is.na(interstate),
                                       interstate,
                                       0),
                   war = ifelse((intrastate == 1 | interstate == 1),
                                1,
                                0)
                   )

```

```{r v-dem_controls, include=FALSE, cache = T}
vdem <- read.csv("../Data/vdem/vdem/V-Dem-CY-Full+Others-v9.csv") 
        
vdem_controls <- vdem %>% 
        filter(year >= 1944) %>% 
        select(cowcode = COWcode,
               ln_gdp_pc = e_migdppcln, 
               year,
               lexical = e_lexical_index,
               tot_pop = e_mipopula,
               urban_pop = e_miurbpop, 
               infant_mortality = e_peinfmor,
               life_expect = e_pelifeex)

analysis_prep$year <- as.numeric(format(analysis_prep$year_month, "%Y"))

analysis_prep <- left_join(analysis_prep, vdem_controls)
analysis_prep <- left_join(analysis_prep, speed_country_month)
```

```{r cleaning_memory_create, include = F, cache = T}
analysis <- analysis_prep %>% 
            group_by(cowcode) %>% 
            filter(year_month >= "Jan 1946", 
                year_month <= "Dec 2006") %>% 
            mutate(complete = ifelse(!is.na(year_month &
                                            cowcode &
                                            ln_gdp_pc &
                                            lexical &
                                            tot_pop &
                                            urban_pop &
                                            infant_mortality &
                                            life_expect),
                                     1,
                                     0),
                   t = seq_along(cowcode), 
                   t2 = t^2,
                   t3 = t^3,
                   pol_ex = ifelse(is.na(mean_pol_express),
                                   0, 
                                   mean_pol_express),
                   mass_express = ifelse(is.na(mean_mass_express), 
                                          0, 
                                          mean_mass_express), 
                   pol_viol = ifelse(is.na(mean_pol_viol), 
                                     0, 
                                     mean_pol_viol), 
                   int_rep = ifelse(is.na(mean_intang_rep),
                                    0, 
                                    1), 
                   tan_rep = ifelse(is.na(mean_st_repress), 
                                    0, 
                                    1), 
                   vio_rep = ifelse(is.na(mean_stat_viol), 
                                    0, 
                                    1)) %>% 
             ungroup() %>% 
             select(cowcode, 
                    t, 
                    year_month,
                    everything())

lags <- analysis %>% 
        group_by(cowcode) %>% 
        arrange(cowcode, year_month) %>% 
        mutate(pol_ex_y1_1 = lag(pol_ex, 1), 
              pol_ex_y1_2 = lag(pol_ex, 2), 
              pol_ex_y1_3 = lag(pol_ex, 3), 
              pol_ex_y1_4 = lag(pol_ex, 4), 
              pol_ex_y1_5 = lag(pol_ex, 5), 
              pol_ex_y1_6 = lag(pol_ex, 6), 
              pol_ex_y1_7 = lag(pol_ex, 7), 
              pol_ex_y1_8 = lag(pol_ex, 8), 
              pol_ex_y1_9 = lag(pol_ex, 9), 
              pol_ex_y1_10 = lag(pol_ex, 10), 
              pol_ex_y1_11 = lag(pol_ex, 11), 
              pol_ex_y1_12 = lag(pol_ex, 12), 
              pol_ex_y2_13 = lag(pol_ex, 13), 
              pol_ex_y2_14 = lag(pol_ex, 14), 
              pol_ex_y2_15 = lag(pol_ex, 15), 
              pol_ex_y2_16 = lag(pol_ex, 16), 
              pol_ex_y2_17 = lag(pol_ex, 17), 
              pol_ex_y2_18 = lag(pol_ex, 18), 
              pol_ex_y2_19 = lag(pol_ex, 19), 
              pol_ex_y2_20 = lag(pol_ex, 20), 
              pol_ex_y2_21 = lag(pol_ex, 21), 
              pol_ex_y2_22 = lag(pol_ex, 22), 
              pol_ex_y2_23 = lag(pol_ex, 23), 
              pol_ex_y2_24 = lag(pol_ex, 24), 
              pol_ex_y3_25 = lag(pol_ex, 25), 
              pol_ex_y3_26 = lag(pol_ex, 26), 
              pol_ex_y3_27 = lag(pol_ex, 27), 
              pol_ex_y3_28 = lag(pol_ex, 28), 
              pol_ex_y3_29 = lag(pol_ex, 29), 
              pol_ex_y3_30 = lag(pol_ex, 30), 
              pol_ex_y3_31 = lag(pol_ex, 31), 
              pol_ex_y3_32 = lag(pol_ex, 32), 
              pol_ex_y3_33 = lag(pol_ex, 33), 
              pol_ex_y3_34 = lag(pol_ex, 34), 
              pol_ex_y3_35 = lag(pol_ex, 35), 
              pol_ex_y3_36 = lag(pol_ex, 36), 
              pol_ex_y4_37 = lag(pol_ex, 37), 
              pol_ex_y4_38 = lag(pol_ex, 38), 
              pol_ex_y4_39 = lag(pol_ex, 39), 
              pol_ex_y4_40 = lag(pol_ex, 40), 
              pol_ex_y4_41 = lag(pol_ex, 41), 
              pol_ex_y4_42 = lag(pol_ex, 42), 
              pol_ex_y4_43 = lag(pol_ex, 43), 
              pol_ex_y4_44 = lag(pol_ex, 44), 
              pol_ex_y4_45 = lag(pol_ex, 45), 
              pol_ex_y4_46 = lag(pol_ex, 46), 
              pol_ex_y4_47 = lag(pol_ex, 47), 
              pol_ex_y4_48 = lag(pol_ex, 48), 
              pol_ex_y5_49 = lag(pol_ex, 49), 
              pol_ex_y5_50 = lag(pol_ex, 50), 
              pol_ex_y5_51 = lag(pol_ex, 51), 
              pol_ex_y5_52 = lag(pol_ex, 52), 
              pol_ex_y5_53 = lag(pol_ex, 53), 
              pol_ex_y5_54 = lag(pol_ex, 54), 
              pol_ex_y5_55 = lag(pol_ex, 55), 
              pol_ex_y5_56 = lag(pol_ex, 56), 
              pol_ex_y5_57 = lag(pol_ex, 57), 
              pol_ex_y5_58 = lag(pol_ex, 58), 
              pol_ex_y5_59 = lag(pol_ex, 59), 
              pol_ex_y5_60 = lag(pol_ex, 60), 
              pol_ex_y6_61 = lag(pol_ex, 61), 
              pol_ex_y6_62 = lag(pol_ex, 62), 
              pol_ex_y6_63 = lag(pol_ex, 63), 
              pol_ex_y6_64 = lag(pol_ex, 64), 
              pol_ex_y6_65 = lag(pol_ex, 65), 
              pol_ex_y6_66 = lag(pol_ex, 66), 
              pol_ex_y6_67 = lag(pol_ex, 67), 
              pol_ex_y6_68 = lag(pol_ex, 68), 
              pol_ex_y6_69 = lag(pol_ex, 69), 
              pol_ex_y6_70 = lag(pol_ex, 70), 
              pol_ex_y6_71 = lag(pol_ex, 71), 
              pol_ex_y6_72 = lag(pol_ex, 72), 
              pol_ex_y7_73 = lag(pol_ex, 73), 
              pol_ex_y7_74 = lag(pol_ex, 74), 
              pol_ex_y7_75 = lag(pol_ex, 75), 
              pol_ex_y7_76 = lag(pol_ex, 76), 
              pol_ex_y7_77 = lag(pol_ex, 77), 
              pol_ex_y7_78 = lag(pol_ex, 78), 
              pol_ex_y7_79 = lag(pol_ex, 79), 
              pol_ex_y7_80 = lag(pol_ex, 80), 
              pol_ex_y7_81 = lag(pol_ex, 81), 
              pol_ex_y7_82 = lag(pol_ex, 82), 
              pol_ex_y7_83 = lag(pol_ex, 83), 
              pol_ex_y7_84 = lag(pol_ex, 84),
              mass_express_y1_1 = lag(mass_express, 1), 
              mass_express_y1_2 = lag(mass_express, 2), 
              mass_express_y1_3 = lag(mass_express, 3), 
              mass_express_y1_4 = lag(mass_express, 4), 
              mass_express_y1_5 = lag(mass_express, 5), 
              mass_express_y1_6 = lag(mass_express, 6), 
              mass_express_y1_7 = lag(mass_express, 7), 
              mass_express_y1_8 = lag(mass_express, 8), 
              mass_express_y1_9 = lag(mass_express, 9), 
              mass_express_y1_10 = lag(mass_express, 10), 
              mass_express_y1_11 = lag(mass_express, 11), 
              mass_express_y1_12 = lag(mass_express, 12), 
              mass_express_y2_13 = lag(mass_express, 13), 
              mass_express_y2_14 = lag(mass_express, 14), 
              mass_express_y2_15 = lag(mass_express, 15), 
              mass_express_y2_16 = lag(mass_express, 16), 
              mass_express_y2_17 = lag(mass_express, 17), 
              mass_express_y2_18 = lag(mass_express, 18), 
              mass_express_y2_19 = lag(mass_express, 19), 
              mass_express_y2_20 = lag(mass_express, 20), 
              mass_express_y2_21 = lag(mass_express, 21), 
              mass_express_y2_22 = lag(mass_express, 22), 
              mass_express_y2_23 = lag(mass_express, 23), 
              mass_express_y2_24 = lag(mass_express, 24), 
              mass_express_y3_25 = lag(mass_express, 25), 
              mass_express_y3_26 = lag(mass_express, 26), 
              mass_express_y3_27 = lag(mass_express, 27), 
              mass_express_y3_28 = lag(mass_express, 28), 
              mass_express_y3_29 = lag(mass_express, 29), 
              mass_express_y3_30 = lag(mass_express, 30), 
              mass_express_y3_31 = lag(mass_express, 31), 
              mass_express_y3_32 = lag(mass_express, 32), 
              mass_express_y3_33 = lag(mass_express, 33), 
              mass_express_y3_34 = lag(mass_express, 34), 
              mass_express_y3_35 = lag(mass_express, 35), 
              mass_express_y3_36 = lag(mass_express, 36), 
              mass_express_y4_37 = lag(mass_express, 37), 
              mass_express_y4_38 = lag(mass_express, 38), 
              mass_express_y4_39 = lag(mass_express, 39), 
              mass_express_y4_40 = lag(mass_express, 40), 
              mass_express_y4_41 = lag(mass_express, 41), 
              mass_express_y4_42 = lag(mass_express, 42), 
              mass_express_y4_43 = lag(mass_express, 43), 
              mass_express_y4_44 = lag(mass_express, 44), 
              mass_express_y4_45 = lag(mass_express, 45), 
              mass_express_y4_46 = lag(mass_express, 46), 
              mass_express_y4_47 = lag(mass_express, 47), 
              mass_express_y4_48 = lag(mass_express, 48), 
              mass_express_y5_49 = lag(mass_express, 49), 
              mass_express_y5_50 = lag(mass_express, 50), 
              mass_express_y5_51 = lag(mass_express, 51), 
              mass_express_y5_52 = lag(mass_express, 52), 
              mass_express_y5_53 = lag(mass_express, 53), 
              mass_express_y5_54 = lag(mass_express, 54), 
              mass_express_y5_55 = lag(mass_express, 55), 
              mass_express_y5_56 = lag(mass_express, 56), 
              mass_express_y5_57 = lag(mass_express, 57), 
              mass_express_y5_58 = lag(mass_express, 58), 
              mass_express_y5_59 = lag(mass_express, 59), 
              mass_express_y5_60 = lag(mass_express, 60), 
              mass_express_y6_61 = lag(mass_express, 61), 
              mass_express_y6_62 = lag(mass_express, 62), 
              mass_express_y6_63 = lag(mass_express, 63), 
              mass_express_y6_64 = lag(mass_express, 64), 
              mass_express_y6_65 = lag(mass_express, 65), 
              mass_express_y6_66 = lag(mass_express, 66), 
              mass_express_y6_67 = lag(mass_express, 67), 
              mass_express_y6_68 = lag(mass_express, 68), 
              mass_express_y6_69 = lag(mass_express, 69), 
              mass_express_y6_70 = lag(mass_express, 70), 
              mass_express_y6_71 = lag(mass_express, 71), 
              mass_express_y6_72 = lag(mass_express, 72), 
              mass_express_y7_73 = lag(mass_express, 73), 
              mass_express_y7_74 = lag(mass_express, 74), 
              mass_express_y7_75 = lag(mass_express, 75), 
              mass_express_y7_76 = lag(mass_express, 76), 
              mass_express_y7_77 = lag(mass_express, 77), 
              mass_express_y7_78 = lag(mass_express, 78), 
              mass_express_y7_79 = lag(mass_express, 79), 
              mass_express_y7_80 = lag(mass_express, 80), 
              mass_express_y7_81 = lag(mass_express, 81), 
              mass_express_y7_82 = lag(mass_express, 82), 
              mass_express_y7_83 = lag(mass_express, 83), 
              mass_express_y7_84 = lag(mass_express, 84),
              pol_viol_y1_1 = lag(pol_viol, 1), 
              pol_viol_y1_2 = lag(pol_viol, 2), 
              pol_viol_y1_3 = lag(pol_viol, 3), 
              pol_viol_y1_4 = lag(pol_viol, 4), 
              pol_viol_y1_5 = lag(pol_viol, 5), 
              pol_viol_y1_6 = lag(pol_viol, 6), 
              pol_viol_y1_7 = lag(pol_viol, 7), 
              pol_viol_y1_8 = lag(pol_viol, 8), 
              pol_viol_y1_9 = lag(pol_viol, 9), 
              pol_viol_y1_10 = lag(pol_viol, 10), 
              pol_viol_y1_11 = lag(pol_viol, 11), 
              pol_viol_y1_12 = lag(pol_viol, 12), 
              pol_viol_y2_13 = lag(pol_viol, 13), 
              pol_viol_y2_14 = lag(pol_viol, 14), 
              pol_viol_y2_15 = lag(pol_viol, 15), 
              pol_viol_y2_16 = lag(pol_viol, 16), 
              pol_viol_y2_17 = lag(pol_viol, 17), 
              pol_viol_y2_18 = lag(pol_viol, 18), 
              pol_viol_y2_19 = lag(pol_viol, 19), 
              pol_viol_y2_20 = lag(pol_viol, 20), 
              pol_viol_y2_21 = lag(pol_viol, 21), 
              pol_viol_y2_22 = lag(pol_viol, 22), 
              pol_viol_y2_23 = lag(pol_viol, 23), 
              pol_viol_y2_24 = lag(pol_viol, 24), 
              pol_viol_y3_25 = lag(pol_viol, 25), 
              pol_viol_y3_26 = lag(pol_viol, 26), 
              pol_viol_y3_27 = lag(pol_viol, 27), 
              pol_viol_y3_28 = lag(pol_viol, 28), 
              pol_viol_y3_29 = lag(pol_viol, 29), 
              pol_viol_y3_30 = lag(pol_viol, 30), 
              pol_viol_y3_31 = lag(pol_viol, 31), 
              pol_viol_y3_32 = lag(pol_viol, 32), 
              pol_viol_y3_33 = lag(pol_viol, 33), 
              pol_viol_y3_34 = lag(pol_viol, 34), 
              pol_viol_y3_35 = lag(pol_viol, 35), 
              pol_viol_y3_36 = lag(pol_viol, 36), 
              pol_viol_y4_37 = lag(pol_viol, 37), 
              pol_viol_y4_38 = lag(pol_viol, 38), 
              pol_viol_y4_39 = lag(pol_viol, 39), 
              pol_viol_y4_40 = lag(pol_viol, 40), 
              pol_viol_y4_41 = lag(pol_viol, 41), 
              pol_viol_y4_42 = lag(pol_viol, 42), 
              pol_viol_y4_43 = lag(pol_viol, 43), 
              pol_viol_y4_44 = lag(pol_viol, 44), 
              pol_viol_y4_45 = lag(pol_viol, 45), 
              pol_viol_y4_46 = lag(pol_viol, 46), 
              pol_viol_y4_47 = lag(pol_viol, 47), 
              pol_viol_y4_48 = lag(pol_viol, 48), 
              pol_viol_y5_49 = lag(pol_viol, 49), 
              pol_viol_y5_50 = lag(pol_viol, 50), 
              pol_viol_y5_51 = lag(pol_viol, 51), 
              pol_viol_y5_52 = lag(pol_viol, 52), 
              pol_viol_y5_53 = lag(pol_viol, 53), 
              pol_viol_y5_54 = lag(pol_viol, 54), 
              pol_viol_y5_55 = lag(pol_viol, 55), 
              pol_viol_y5_56 = lag(pol_viol, 56), 
              pol_viol_y5_57 = lag(pol_viol, 57), 
              pol_viol_y5_58 = lag(pol_viol, 58), 
              pol_viol_y5_59 = lag(pol_viol, 59), 
              pol_viol_y5_60 = lag(pol_viol, 60), 
              pol_viol_y6_61 = lag(pol_viol, 61), 
              pol_viol_y6_62 = lag(pol_viol, 62), 
              pol_viol_y6_63 = lag(pol_viol, 63), 
              pol_viol_y6_64 = lag(pol_viol, 64), 
              pol_viol_y6_65 = lag(pol_viol, 65), 
              pol_viol_y6_66 = lag(pol_viol, 66), 
              pol_viol_y6_67 = lag(pol_viol, 67), 
              pol_viol_y6_68 = lag(pol_viol, 68), 
              pol_viol_y6_69 = lag(pol_viol, 69), 
              pol_viol_y6_70 = lag(pol_viol, 70), 
              pol_viol_y6_71 = lag(pol_viol, 71), 
              pol_viol_y6_72 = lag(pol_viol, 72), 
              pol_viol_y7_73 = lag(pol_viol, 73), 
              pol_viol_y7_74 = lag(pol_viol, 74), 
              pol_viol_y7_75 = lag(pol_viol, 75), 
              pol_viol_y7_76 = lag(pol_viol, 76), 
              pol_viol_y7_77 = lag(pol_viol, 77), 
              pol_viol_y7_78 = lag(pol_viol, 78), 
              pol_viol_y7_79 = lag(pol_viol, 79), 
              pol_viol_y7_80 = lag(pol_viol, 80), 
              pol_viol_y7_81 = lag(pol_viol, 81), 
              pol_viol_y7_82 = lag(pol_viol, 82), 
              pol_viol_y7_83 = lag(pol_viol, 83), 
              pol_viol_y7_84 = lag(pol_viol, 84)
)

lags_years <- lags %>% 
              mutate(pol_viol_y1 = pol_viol_y1_1 + pol_viol_y1_2 + pol_viol_y1_3 + pol_viol_y1_4 + pol_viol_y1_5 + pol_viol_y1_6 + pol_viol_y1_7 + pol_viol_y1_8 + pol_viol_y1_9 + pol_viol_y1_10 + pol_viol_y1_11 + pol_viol_y1_12,
                     
                     pol_viol_y2 = pol_viol_y2_13 + pol_viol_y2_14 + pol_viol_y2_15 + pol_viol_y2_16 + pol_viol_y2_17 + pol_viol_y2_18 + pol_viol_y2_19 + pol_viol_y2_20 + pol_viol_y2_21 + pol_viol_y2_22 + pol_viol_y2_23 + pol_viol_y2_24,
                     
                     pol_viol_y3 = pol_viol_y3_25 + pol_viol_y3_26 + pol_viol_y3_27 + pol_viol_y3_28 + pol_viol_y3_29 + pol_viol_y3_30 + pol_viol_y3_31 + pol_viol_y3_32 + pol_viol_y3_33 + pol_viol_y3_34 + pol_viol_y3_35 + pol_viol_y3_36,
                     
                     pol_viol_y4 = pol_viol_y4_37 + pol_viol_y4_38 + pol_viol_y4_39 + pol_viol_y4_40 + pol_viol_y4_41 + pol_viol_y4_42 + pol_viol_y4_43 + pol_viol_y4_44 + pol_viol_y4_45 + pol_viol_y4_46 + pol_viol_y4_47 + pol_viol_y4_48,
                     
                     pol_viol_y5 = pol_viol_y5_49 + pol_viol_y5_50 + pol_viol_y5_51 + pol_viol_y5_52 + pol_viol_y5_53 + pol_viol_y5_54 + pol_viol_y5_55 + pol_viol_y5_56 + pol_viol_y5_57 + pol_viol_y5_58 + pol_viol_y5_59 + pol_viol_y5_60,
                     
                     pol_viol_y6 = pol_viol_y6_61 + pol_viol_y6_62 + pol_viol_y6_63 + pol_viol_y6_64 + pol_viol_y6_65 + pol_viol_y6_66 + pol_viol_y6_67 + pol_viol_y6_68 + pol_viol_y6_69 + pol_viol_y6_70 + pol_viol_y6_71 + pol_viol_y6_72,
                     
                     pol_viol_y7 = pol_viol_y7_73 + pol_viol_y7_74 + pol_viol_y7_75 + pol_viol_y7_76 + pol_viol_y7_77 + pol_viol_y7_78 + pol_viol_y7_79 + pol_viol_y7_80 + pol_viol_y7_81 + pol_viol_y7_82 + pol_viol_y7_83 + pol_viol_y7_84,
                     
                     mass_express_y1 = mass_express_y1_1 + mass_express_y1_2 + mass_express_y1_3 + mass_express_y1_4 + mass_express_y1_5 + mass_express_y1_6 + mass_express_y1_7 + mass_express_y1_8 + mass_express_y1_9 + mass_express_y1_10 + mass_express_y1_11 + mass_express_y1_12,
                     
                    mass_express_y2 = mass_express_y2_13 + mass_express_y2_14 + mass_express_y2_15 + mass_express_y2_16 + mass_express_y2_17 + mass_express_y2_18 + mass_express_y2_19 + mass_express_y2_20 + mass_express_y2_21 + mass_express_y2_22 + mass_express_y2_23 + mass_express_y2_24,
                    
                    mass_express_y3 = mass_express_y3_25 + mass_express_y3_26 + mass_express_y3_27 + mass_express_y3_28 + mass_express_y3_29 + mass_express_y3_30 + mass_express_y3_31 + mass_express_y3_32 + mass_express_y3_33 + mass_express_y3_34 + mass_express_y3_35 + mass_express_y3_36,
                    
                    mass_express_y4 = mass_express_y4_37 + mass_express_y4_38 + mass_express_y4_39 + mass_express_y4_40 + mass_express_y4_41 + mass_express_y4_42 + mass_express_y4_43 + mass_express_y4_44 + mass_express_y4_45 + mass_express_y4_46 + mass_express_y4_47 + mass_express_y4_48,
                    
                    mass_express_y5 = mass_express_y5_49 + mass_express_y5_50 + mass_express_y5_51 + mass_express_y5_52 + mass_express_y5_53 + mass_express_y5_54 + mass_express_y5_55 + mass_express_y5_56 + mass_express_y5_57 + mass_express_y5_58 + mass_express_y5_59 + mass_express_y5_60,
                    
                    mass_express_y6 = mass_express_y6_61 + mass_express_y6_62 + mass_express_y6_63 + mass_express_y6_64 + mass_express_y6_65 + mass_express_y6_66 + mass_express_y6_67 + mass_express_y6_68 + mass_express_y6_69 + mass_express_y6_70 + mass_express_y6_71 + mass_express_y6_72,
                    
                    mass_express_y7 = mass_express_y7_73 + mass_express_y7_74 + mass_express_y7_75 + mass_express_y7_76 + mass_express_y7_77 + mass_express_y7_78 + mass_express_y7_79 + mass_express_y7_80 + mass_express_y7_81 + mass_express_y7_82 + mass_express_y7_83 + mass_express_y7_84,

                    pol_ex_y1 = pol_ex_y1_1 + pol_ex_y1_2 + pol_ex_y1_3 + pol_ex_y1_4 + pol_ex_y1_5 + pol_ex_y1_6 + pol_ex_y1_7 + pol_ex_y1_8 + pol_ex_y1_9 + pol_ex_y1_10 + pol_ex_y1_11 + pol_ex_y1_12,
                     
                    pol_ex_y2 = pol_ex_y2_13 + pol_ex_y2_14 + pol_ex_y2_15 + pol_ex_y2_16 + pol_ex_y2_17 + pol_ex_y2_18 + pol_ex_y2_19 + pol_ex_y2_20 + pol_ex_y2_21 + pol_ex_y2_22 + pol_ex_y2_23 + pol_ex_y2_24,
                    
                    pol_ex_y3 = pol_ex_y3_25 + pol_ex_y3_26 + pol_ex_y3_27 + pol_ex_y3_28 + pol_ex_y3_29 + pol_ex_y3_30 + pol_ex_y3_31 + pol_ex_y3_32 + pol_ex_y3_33 + pol_ex_y3_34 + pol_ex_y3_35 + pol_ex_y3_36,
                    
                    pol_ex_y4 = pol_ex_y4_37 + pol_ex_y4_38 + pol_ex_y4_39 + pol_ex_y4_40 + pol_ex_y4_41 + pol_ex_y4_42 + pol_ex_y4_43 + pol_ex_y4_44 + pol_ex_y4_45 + pol_ex_y4_46 + pol_ex_y4_47 + pol_ex_y4_48,
                    
                    pol_ex_y5 = pol_ex_y5_49 + pol_ex_y5_50 + pol_ex_y5_51 + pol_ex_y5_52 + pol_ex_y5_53 + pol_ex_y5_54 + pol_ex_y5_55 + pol_ex_y5_56 + pol_ex_y5_57 + pol_ex_y5_58 + pol_ex_y5_59 + pol_ex_y5_60,
                    
                    pol_ex_y6 = pol_ex_y6_61 + pol_ex_y6_62 + pol_ex_y6_63 + pol_ex_y6_64 + pol_ex_y6_65 + pol_ex_y6_66 + pol_ex_y6_67 + pol_ex_y6_68 + pol_ex_y6_69 + pol_ex_y6_70 + pol_ex_y6_71 + pol_ex_y6_72,
                    
                    pol_ex_y7 = pol_ex_y7_73 + pol_ex_y7_74 + pol_ex_y7_75 + pol_ex_y7_76 + pol_ex_y7_77 + pol_ex_y7_78 + pol_ex_y7_79 + pol_ex_y7_80 + pol_ex_y7_81 + pol_ex_y7_82 + pol_ex_y7_83 + pol_ex_y7_84
)

lags_decay <- lags_years %>% 
              mutate(pol_ex_mem = pol_ex_y1^(.9^1) + pol_ex_y2^(.9^2) + pol_ex_y3^(.9^3) + pol_ex_y4^(.9^4) + pol_ex_y5^(.9^5) + pol_ex_y6^(.9^6) + pol_ex_y7^(.9^7),
                     mass_express_mem = mass_express_y1^(.9^1) + mass_express_y2^(.9^2) + mass_express_y3^(.9^3) + mass_express_y4^(.9^4) + mass_express_y5^(.9^5) + mass_express_y6^(.9^6) + mass_express_y7^(.9^7),
                     pol_viol_mem = pol_viol_y1^(.9^1) + pol_viol_y2^(.9^2) + pol_viol_y3^(.9^3) + pol_viol_y4^(.9^4) + pol_viol_y5^(.9^5) + pol_viol_y6^(.9^6) + pol_viol_y7^(.9^7)
                       ) %>% 
              select(cowcode, 
                     year_month,
                     ends_with("mem"), 
                     everything())

final <- left_join(analysis_prep, lags_decay) %>% 
         filter(year_month >= "Jan 1946", 
                year_month <= "Dec 2006")

```


  When do democracies resort to repression?  The literature on the dissent-repression nexus has been active for over forty years, but there are still important methodological improvements that can be made to this literature.  To date, the most concrete findings are summarized in Davenport's [-@davenport2007] literature review: the law of coercive responsiveness, more murder in the middle, and the domestic democratic peace.  The law of coercive responsiveness is that states are most likely to repress in response to a threat.  More murder in the middle is the finding that regime types somewhere between full authoritarian and full democracy are the most violent repressors.  The domestic democratic peace is threefold: democratic institutions increase the costs of state repression, democratic citizens accept democratic values of nonviolent expression and negotiating, and democracies provide alternative measures for political control.  It is important to note that the domestic democratic peace only applies to states that cross a certain threshold of democratic-ness at which point they become ‘full’ democracies [@davenport1995; @davenport1999; @davenport2004; @poe1994; @regan2002a].  

  Further motivation comes from the terrorism literature.  A variety of studies have shown that as democratic citizens perceive their own threat levels increasing, they offer up individual autonomy and rights in exchange for greater security offered by the state [@bloch-elkon2011; @davis2004; @finseraas2013; @mondak2012].  Importantly, this shows that in democracies if the dissent sufficiently threatens the population at large they will accept repression if it means lower perceived threat levels.  This mechanism provides legitimacy for the use of repressive policy by democratic states.  
  I define dissent broadly: any action that is political in motivation and initiated by a non-government entity with the intention of political change.  In measurement, I divide dissent into three categories ^[These divisions are made of practicality. The Social, Political, and Economic Event Database (SPEED) dataset includes pre-calculated indices based upon the discussed divisions above. For more information on the divisions see the SPEED Project White Papers online (http://www.clinecenter.illinois.edu/publication/white/).] that are captured through three distinct independent variables: symbolic dissent, mass dissent, and political violence.  Symbolic dissent ^[Symbolic dissent includes the following types of events: passive resistance, praying, boycotting, blocking egression/regression, withholding something due, disrespecting a national symbol, symbolic burning, return of an exiled leader, self-inflicted harm, resignation in protest, defection, symbolic throwing/wearing, or conducting a walkout. ] requires no mass mobilization and can take the form of leaflets, books, films and other mediums that criticize the state.  Mass dissent is nonviolent mobilization of large groups of people.  Obvious examples of this include protests such as the Women’s March and other such mass protests.  Political violence is the use of violence to create political change.  This definition improves upon recent literature by including a broader conception of dissent and differentiating between different them.  
  
  Davenport [-@davenport2007, p. 2] defines repression as: “the actual or threatened use of physical sanctions against an individual or organization, within the territorial jurisdiction of the state, for the purpose of imposing a cost on the target as well as deterring specific activities and/or beliefs perceived to be challenging to government personnel, practices or institutions.  ” I expand this definition of repression in an important way: the negation of civil liberties such as freedom of speech, religion, association, gathering, and movement in nonviolent ways also constitutes repression.  The literature mostly ignores this type of repression, largely due to data issues.  Much of the repression datasets that exist are based on and developed around violent repression of physical integrity rights [@fransisco1996; @gibney2018; @poe1994], or only take into account human rights violations or scores [@davenport1999; @davenport2004; @regan2002a; @franklin2008; @stohl1986].  I categorize repression into three types: intangible state repression, tangible state repression, and violent repression.  Intangible state repression violates basic rights in a nonviolent manner such as censorship, martial law, imposing curfews, etc.  Tangible state repression involves the use of state capacity to coerce citizens without using violence, detention, or the military.  Violent repression uses lethal force, the military, detention, torture, or any combination of violent measures taken to coerce individuals.  These definitions are provided by the Social, Political, Economic Events Database (SPEED) which is the data used in this project [@nardulli2015].  
	
  Researchers so far have considered only contemporary or directly previous time periods when considering the effect of dissent on state repression with few exceptions [@davenport1996].  By considering only the immediate temporal proximity, the previous analyses have underestimated the effect of residual dissent in state memory.  I will show that when the analysis takes into account the memory of dissent democracies repress in response to persistent recent threats.  I will show that states repress as a reaction to the memory of dissent because that represents the full threat experienced by a state, as well as in response to different types of dissent.  When dissidents take to the street, any actions that they take in isolation are weak relative to state control and power.  However, when the recent history of dissent is considered, the state looks at a broader pattern of dissent and updates its perceived threat level.  As dissent becomes more severe in recent memory, the threat level rises to both the state and the population at large and repression becomes a more attractive tool for political control.  
  
  Another improvement I make in this paper is a more appropriate temporal unit of analysis.  Most existing studies have used country-year units of analysis.  Repression and dissent are both day-to-day activities that can vary greatly in intensity and frequency within a year.  Aggregating both measures to yearly levels loses large amounts of variation in the dependent and explanatory variables.  I use SPEED to generate a country-month unit of analysis that increases the observable temporal variance.  This also allows a more fine-grained analysis of how quickly a state responds to dissent.  
One final improvement I will make on the literature is improving the consideration of democracy as a variable.  Whereas most of the literature to date has broadly used the Polity series of variables as a democratic indicator [@davenport1999; @henderson1991; @poe1994], I will use more explicit definitions of democracy.  I define democracy according to its electoral institutions.  As such, I will use the Lexical Index, which is an additive scale considering electoral components of a state.  I define a full democracy according to a six out of six on the Lexical Index: elections exist, elections allow multiparty competition, legislative and executive offices are filled through election, and full female and male suffrage.  
  
  I find that democracies repress as a response to symbolic dissent and as a response to political violence, but not as a response to mass dissent.  This suggests that democracies will repress if they think it will go unnoticed, or if they think it is legitimate.  
  
##Dissent, Repression, and Response
  
  Before discussing how the state responds to dissent, it is important to note what factors predict state repression in general.  There is a rich literature theorizing and testing different explanatory variables that influence repression without considering it as a response to dissent.  Mitchell and McCormick [-@mitchell1998] provide some of the earliest quantitative analysis.  Their work suggests that state wealth has at least a moderately negative impact on the probability of a state repressing.  Interestingly, they find that states with British colonial heritage are the least likely to repress because of the institutions inherited that make abuse of state powers taboo.  Mitchell and McCormick also show evidence that the most autocratic rulers (e.g. personalist and totalitarian) are the most likely to violate human rights.  
  
  Henderson [-@henderson1991] shows that democracy and economic growth negatively predict repression, while inequality positively predicts repression.  This is the first appearance of the democratic argument in empirical testing.  Poe and Tate [-@poe1994] corroborate this finding but suggest that economic standing alone is enough to dissuade state repression.  Davenport [-@davenport1995] also finds support for the hypothesis that democracies repress less, and he uses Taylor and Jodice [-@taylor1983] measures of repression that focus on nonviolent repression.  Davenport and Armstrong [@davenport2004] employ nonparametric testing in an atheoretical examination to show that states must hit a certain threshold of democratic-ness before repression starts to decline.  This is the emergence of the “more murder in the middle”[@davenport2007, pp.  11] pattern: states at the extreme ends of regime types have no need for repression, but states in between the extremes face different obstacles that makes repression more likely.  This is because full autocracies have consolidated power and little respect for human rights initially, and thus are unhindered in their use of repression as a policy tool.  This creates an expectation that repression would be a standard response to dissent, and thus dissent is less likely, and repression is less necessary.  In full democracies repression is theoretically an unacceptable policy tool, while (nonviolent) dissent is a protected civil liberty.  Therefore, dissent should not beget repression both because it is legal and because the state’s use of repression would be illegitimate.  
  
  A last variable influencing state repression independent of dissent is whether a state is involved in a war.  Poe and Tate [-@poe1994] find that wars increase repression domestically because a state needs to maintain political control more during turbulent political times.  Danneman and Ritter [-@danneman2014] show that states recognize the contagion threat of neighboring civil wars and preemptively repress their own population in order to maintain power and quell potential rebellion.  
  
  Davenport [-@davenport1995] suggests that a state’s threat perception is a function of three dissent factors: frequency, severity, and variety.  As these three factors increase, states perceive threat as being greater and become more likely to repress.  They also show that as levels of dissent differ from the norm (average level of dissent), states perceive a greater threat and repress more often.  Regan and Henderson [-@regan2002a] corroborate this finding broadly showing that states that feel threatened now are more likely to repress.  Davenport [-@davenport1996] later shows that lagged yearly sums of political conflict positively associate with repression, but he does not test for moving sums or moving averages.  Moore [-@moore2000] shows that states change their strategy for dealing with dissent (accommodation or repression) when the current strategy is met with further dissent.  
  
  The relationship between dissidents and repressors is also likely endogenous.  Lichbach [-@lichbach1987] developed a model of dissident response to repression.  In this model, dissidents have two dissent options: legal (nonviolent) and illegal (violent).  Dissidents prefer to use more effective dissent strategies and will invest more time and money into those strategies.  When states recognize which strategies are more successful (gain more accommodation) states will selectively repress to lower the efficacy of dissident movements.  This model suggests that when states begin to repress strategically, overall levels of dissent increase as dissidents increase quantity of dissent to make up for lost quality of dissent.  Moore [-@moore1998] tests this model against other theorized relationships and finds support for exclusively Lichbach’s argument.  
  
  Francisco [-@francisco1995; -@francisco1996] compares all theorized dissent responses to repression.  He identifies five theorized relationships: backlash, inverted-U, nonlinear, and adaptive.  A backlash relationship predicts an absolute increase in dissent as a response to repression.  An inverted-U response posits that at high and low levels of repression dissent is uncommon, but the middle-ground sees high levels of dissent.  The nonlinear relationship suggests that repression and dissent oscillate in a relatively unpredictable manner.  The adaptive dynamic is Lichbach’s pattern.  Francisco also finds comparatively more evidence for Lichbach’s dynamic theory.  
  
  The literature has not yet utilized computer coded event datasets to test the dynamics of the dissent-repression nexus.  Moreover, no work to date has provided a comprehensive long-run analysis across all states in the post-WWII period.  The SPEED dataset allows me to do that.  Datasets used in the past have been limited to least developed countries [@regan2002a], violent dissent types [@davenport1995; @francisco1996; @moore1998; @moore2000; @regan2002a], and yearly aggregations [@davenport1996; @moore1998; @moore2000] or single-year estimations [@henderson1991; @henderson1993].  Additionally, all previous work is more constrained in its temporal domain than this analysis.  These all contribute in important ways to the basis of the theory proposed in the next section.  I intend to expand upon their theory and use better fine-grained data to estimate my models.
  
##State Memory of Dissent and the Use of Repression  
  
  This theory is based on two fundamentally assumed goals of leaders that do not vary across regime types: political survival [@buenodemesquita2003], and the provision of security for the state.  All leaders today want to be leaders tomorrow, and political survival is of the utmost importance.  The manner in which political survival is secured can vary greatly across regime types from the co-optation, legitimation, and repression in autocracies [@gerschewski2013] to electoral success in democracies.  The provision of security can be broadly interpreted as the provision of any necessary public goods to prevent the state from descending into anarchic chaos of continual violence.  This assumption is intentionally broad to show that a leader must provide, at minimum, security sufficient to maintain territorial integrity, and at best, prosperity and high standards of living.  
  
  It is important to note that security is not strictly a public good because it is potentially excludable from certain populations (e.g. selective repression of minority groups).  Security defined as maintaining the territorial integrity of the state (i.e. avoiding civil war and state collapse), however, is non-excludable.  This type of security provision is particularly salient to the theoretical understanding of repression in democracies because without territorial integrity the leadership of the state has no governing authority.  Once dissent presents a sufficient threat to the security of the state defined this way the state can legitimately repress or violate civil liberties in order to provide security.  There is ample evidence in the terrorism literature that in democracies leadership even has support for such actions [@bloch-elkon2011; @davis2004; @mondak2012].  
  
  According to modern democratic theory, democracies are committed to civil liberties and human dignity rights in a broad sense [@dahl1989; @ober2012].  Power in democracies is derived through legitimate electoral success and popular support.  Democratic norms of nonviolent bargaining differ starkly from the less institutionalized bargaining practices of autocracies [@haggard2016].  Because of these norms, policymaking in democratic states consists of policy changes to provide sufficient public and private goods to gain support of a winning coalition.  Leadership which provides unsatisfactory policy to accrue sufficient support to create a winning coalition will lose upcoming elections and be replaced.  Leaders must respond to dissent with policy in ways that provide sufficient security to please their winning coalition.  Given that this paper considers only full democracies, this winning coalition is at least half the population.  In a majoritarian system like the US the president must please the at least half of the voters to keep his seat.  In a proportional representation system like the UK the policy of the prime minister must please his/her own party as well as any parties also a member of a coalition government.  
  
  Policy made by incumbents must not contradict the basis of democratic rule: respect for civil liberties and human dignity rights.  However, leaders are also afforded some leeway to act because of democratic legitimacy: leaders won their power through free and fair electoral processes and are therefore entitled to some autonomy in responding to threats as they see fit.  They must respond in ways that do not compromise their chances of future political success.  In  an optimistic view of democratic governance leaders may only resort to repression once the level of threat is sufficiently high that repressive policy is the best way to assure security for the state and satisfy the winning coalition.  
  
  The difficulty of traditional definitions of democracies as commitments to human rights is that these states will by definition never repress, even nonviolently.  I chose to define democracies in terms of electoral institutions because it largely escapes the tautology just described and allows for states that are electorally democratic to be logically capable of repressing in the coding scheme.  This definition and operationalization still assumes that elections are free and suffrage is universal, but it makes no assumptions about state behavior beyond their behavior around elections.  
  
  When dissidents dissent, political survival and state security are both potentially threatened.  Threat has been previously theorized to be a function of: quantity of dissent, number of strategy types, severity, and difference from the norm [@davenport1995].  I distinguish between three main types of dissent: symbolic “small-gauge” dissent, mass dissent, and political violence.  Symbolic dissent is nonviolent non-mass dissent that express political discontent.  Mass dissent is also nonviolent, and can employ similar strategies as symbolic dissent, but requires a mass mobilization component.  Political violence is the use of force by non-state actors to express discontent with the state.  
  
  Across those types of dissent, one should expect different responses.  Some dissent is less threatening than others.  Nonviolent dissent poses little physical threat to the state and offers no legitimate justification for the use of repression, especially violent repression, to quell dissent.  Mass protest poses no direct physical threat to the state because it is nonviolent, however it signals two dangers for the state: the issue is sufficiently salient to generate dissent, and there is broad enough support for the dissenting message to generate mass gatherings.  However, it is possible that malicious leaders that do not truly respect the democratic norms of governance may view symbolic dissent and mass protest as a threat to their own potential political success.  In this context the state is confronted with incentives to act, but the form of those actions depends on what the state may legitimately do.  Democracies cannot legitimately use force or restrict civil liberties because of such protest because they are rights protected by the democratic constitutions.  This leads to the first expectation of this project: nonviolent dissent should never generate repressive responses from democratic leaders.  Because democracies promise civil liberties that make nonviolent dissent possible, it would be illegitimate for democratic leaders to restrict civil liberties or use violent repression to quell nonviolent dissent.  Any results to the contrary would suggest that democratic leaders are not as willing to uphold civil liberties as they claim.

>Hypothesis 1: Democracies will not use any type of repression (intangible, tangible, or violent) in response to nonviolent dissent (symbolic or mass).  
  
  Political violence presents a threat to the state and civilians, thus legitimizing the government use of force in all regimes types and potentially increasing mass support of repressive governing [@davis2004].  However, political violence is not a carte blanche for violent repression in democracies.  States have a variety of tools that they should exhaust before resorting to any sort of violent repression, and even in those cases where violent repression is used it should be targeted and selective in order to minimize the threat.  A real-world example of a full democracy repressing in the face of threat can be seen in France in 2016.  In response to a string of terrorist attacks claimed by ISIS, France declared a state of emergency which restricts certain rights of citizens, and then proposed to change and expand the powers elected officials have [@breedon2016].  A similar example can be seen in the US response to 9/11 with the Patriot Act, which expanded the power of the government to gather information about the citizens that should be protected by the prerequisite of a warrant to gather personal information [@baker2015].  In both cases, nonviolent means were used to expand the reach of the state in favor of expanding the state’s ability to provide security.  Research has also shown that the population supports these changes as they feel threat levels increasing [@davis2004; @mondak2012].  
  
  Theoretically, expanding governmental powers and implementing nonviolent repression via monitoring and information collection, detentions, curfews, martial law, and declaring states of emergency as discussed above allows the government to provide better security in a nonviolent manner.  At the same time, providing security in these ways violates the civil liberties the state is required to defend to maintain its democratic status in the normative sense, but it is unaffected by the electoral definition implemented here.  I expect that given sufficient threat over time resulting from political violence democracies will implement intangible and tangible repression first, and then violent repression only in the face of extraordinarily threatening circumstances.  
  
>Hypothesis 2: As political violence increases over time in democracies leadership will be more likely to implement repressive policies to ensure security.  
  
  The threat dissent poses accrues in memory over time.  This factor has not been accounted for empirically in the literature.  Dissent at time t may be independent in motivation and population from dissent at time t-1, but the state recalls and is potentially threatened by both events regardless of whether they are ideologically connected.  More importantly, theories of repression suggest that the frequency and severity, in conjunction, are important in determining the states threat perception [@davenport1995].  A state’s leadership wants to survive politically and protect the state as a whole.  As a result, its threat perception is a function of all recent previous dissent.  
  
  In order to test the temporal dynamics of state memory of dissent there must be an explicit memory length to test.  Theorizing about memory length is arbitrary.  Human recall is not infinite, nor is it absolutely confined to a certain number of days or years.  Empirically, Davenport [-@davenport1996] agnostically estimates a cross-correlation lag distribution analysis of past years of dissent on current levels of repression and the data shows that lagged dissent positively correlates and is statistically significant up to seven years in the past.  I will adopt a seven year memory length in testing the temporal dynamics ^[Ultimately the lag length is irrelevant given the decay function I choose. Events that happen around seven years ago have a very small, near zero, value because of the decay function. Thus, this choice follows the literature and also simplifies coding schemes.].  
  
  Another important aspect of memory is its decay.  Individuals remember what happened yesterday better than what happened last month.  The exception to this rule is when last month’s event was especially noteworthy.  To account for this aspect of human memory, I must model the decay of the impact of previous events.  To account for this, I institute a measure of dissent memory that incorporates a decay function over the last seven years.  This is discussed at greater length in the research design section.  Simply put: dissent that happened longer ago is downwardly weighted in memory through a decay function that allows particularly severe or intense events to have a longer-lasting presence in the state’s memory of dissent.  The broad expectation as discussed above is: as the memory of violent dissent increases, the state’s perceived level of threat increases, and repression becomes more likely.  
  
  Previous research analyzes regime types together, and here I analyze democracies independently of nondemocracies.  Thus, while this expectation is not particularly novel in general, it is novel to expect that this is a persistent effect in democracies.  Once dissidents have crossed the threshold to use violence the state has legitimacy in using force to stop them for two reasons: they must stop them to provide security for the general public and if they do not provide security they face potential competency costs [@gelpi2015; @smith1998a].  I also expect that states will apply all possible repressive tools in the context of extreme violent dissent because of the seriousness of the threat political violence poses: states will do whatever possible to address the security threat, and they will have legitimacy in doing so because political violence is already occurring.  
  
### Data and Research Design  
  
  I use the SPEED data aggregated at the monthly level.  My level of analysis is country-month.  The SPEED data covers 192 countries, the Lexical Index covers 173 countries, and I include only full democracies on the Lexical Index scale (6 out of 6) [@skaaning1995].  This constrains my analysis 96 countries since World War II.  
  
  The SPEED dataset uses machine coded news articles to gather information about dissent and repression events from around the world.  It gathers information from a variety of news sources and codes the types of initiators (government or nongovernment), the types of events, the number of participants, the length of event, the severity (number killed and injured), and several other variables.  Because the data is machine generated, it lacks the preciseness that comes with human coding, but it gains the advantage of having more observations at smaller time intervals.  The data in its original form has the event as the unit of analysis with start and end dates specified.  To account for dissent events that lasted long periods of time I had to make some simplifying assumptions.  First, I expanded the data so that each event has one observation for each month in which it was active at least one day.  Second, I have no choice but to assume that the overall repression and dissent scores given in the SPEED data is constant over the entire period that the event was active.  For example, say that there was an event with high levels of dissent that lasted six months, due to the data’s original format my only option is to assume that the dissent level was equally high for each of the six months.  This is the most egregious assumption I make.  After all events had one observation per month in which they occurred, I collapsed all observations and took the average levels of dissent and repression according to the types discussed for each month.  At this point, the unit of analysis becomes country-month, and each dissent types has only one average value per country-month.  
  
  The dependent variable is a binary indicator of repression.  The dataset specifies three types of repression: intangible, tangible, and violent.  The dependent variables is coded zero if no repression occurs, and one if the corresponding type of repression occurs.  I choose to binarize the data because I only really am concerned with whether or not repression occurs, not how bad the repression was.  
  
  The primary independent variables are the memory of each type of dissent.  These variables are continuous.  Symbolic “small-gauge” dissent is made up of four variables: whether the event was symbolic, whether the event had more than ten initiators, the length of the event, and whether violence is advocated .  Mass dissent is a function of: the number participating, whether a weapon was used, or injury was caused, and whether violence was advocated.  Political violence is a function of: whether the attack was targeted at a person, an ordinal weapons grade scale, and a count of those killed and injured.  
  
  The memory variable was crafted using an exponential decay function.  I use the seven year memory length suggested by Davenport [@davenport1996].  The memory of dissent is equal to  
<center>  
$$Dissent Memory_{mk} = \sum_{y=1}^{7}\sum_{m=1}^{12} dissent_{ym}^{.9^y}$$.
</center>  
  
  Where k is the temporal distance in terms of years and m is the temporal distance in terms of months.  For example, for the country-month observation of January 2000, k=1 is the year of December 1999 to December 1998, and each month in this year is m \(\epsilon\) 1:12.  Intuitively, this function sums the values for all months in a year.  Then, that sum is exponentiated to the  .9 to the y.  For one year in the past y is equal to one, and so on.  Using January 2000 as an example still, the summed dissent of a year seven years ago was taken to the power of $.9^7 = 0.48$.  Assume the political violence has a value of 200 for this month, its contribution to memory seven years later is $200^{.9^7} = 12.61$.  This function downwardly weights the events of the past, as they become less recent up to seven years, at which point they are dropped from memory.  
  
  Relevant controls include: logged GDP per capita in constant 2011 US Dollars, total population, urban population [@coppedge2011], and whether or not the state was currently experiencing a war according to the Correlates of War dataset [@sarkees2010].  Economic development has been hypothesized to decrease the likelihood of repression [@henderson1991].  States in wars have been shown to repress more often as a way to secure the domestic front [@young2013].  
  
  Because my dependent variable is binary, I will use logistic regression to test my hypotheses.  The unit of analysis is country-month, but some variables vary at the country-year unit of analysis.  To deal with this multilevel structure of the data I use random effects models using the year as the random intercept variable.  This corrects standard errors that would have been misspecified using standard logistic regression and allows confident hypothesis testing.  To account for time I implement Carter and Signorino’s [@carter2010] advice and use a time polynomial.  
  
  To account for  the highly correlated nature of my dissent variables I estimate them in separate models. I also rescale each variable in the analysis to be between zero (the overall minimum) and one (the overall maximum) because the drastic difference in ranges causes estimation problems.  Each type of repression represents its own dependent variable, so there are three sets of three estimations.  It is logical to assume that if higher levels of dissent such as political violence or mass protests are occurring then lower levels of dissent are also occurring.  However, because these variables are highly correlated they cannot be included in the same model.  In the fourth model the summed memory of dissent presents the total memory of all dissent types added together.  The results below are coefficient plots of the standardized variables.  
  
## Results and Discussion
```{r final analysis object, cache=TRUE, include=F}
analysis_final <- final %>% 
                  filter(lexical == 6) %>% 
            select(cowcode, 
                   year_month, 
                   intrastate, 
                   year, 
                   ln_gdp_pc,
                   lexical,
                   tot_pop,
                   urban_pop,
                   infant_mortality,
                   life_expect,
                   pol_ex_mem,
                   mass_express_mem,
                   pol_viol_mem, 
                   int_rep, 
                   tan_rep, 
                   vio_rep, 
                   t, 
                   t2, 
                   t3) %>% 
             mutate(ln_polex_mem = log10(pol_ex_mem + 1), 
                    ln_massex_mem = log10(mass_express_mem + 1), 
                    ln_polvio_mem = log10(pol_viol_mem + 1), 
                    totpop10k = tot_pop/10000, 
                    urbanpop10k = urban_pop/10000,
                    lnt = log10(t),
                    lnt2 = log10(t2),
                    lnt3 = log10(t3)) 

library(lme4)
library(dotwhisker)
```	

```{r Intangible Repression Symbolic Dissent, include = F, cache = T}
int_polex <- glmer(int_rep ~ 
                     ln_polex_mem + 
                     intrastate + 
                     ln_gdp_pc +
                     totpop10k + 
                     urbanpop10k + 
                     lnt +
                     lnt2 + 
                     lnt3 + 
                     (1 | cowcode), 
                   family = binomial,
                   data = analysis_final)
```

```{r Intangible Repression Mass Expression, include = F, cache = T}
int_massex <- glmer(int_rep ~ 
                     ln_massex_mem + 
                     intrastate + 
                     ln_gdp_pc +
                     totpop10k + 
                     urbanpop10k + 
                     lnt +
                     lnt2 + 
                     lnt3 + 
                     (1 | cowcode), 
                   family = binomial,
                   data = analysis_final)
```

```{r Intangible Repression Political Violence, include = F, cache = T}
int_polvio <- glmer(int_rep ~ 
                     ln_polvio_mem + 
                     intrastate + 
                     ln_gdp_pc +
                     totpop10k + 
                     urbanpop10k + 
                     lnt +
                     lnt2 + 
                     lnt3 + 
                     (1 | cowcode), 
                   family = binomial,
                   data = analysis_final)
```

```{r Tangible Repression Symbolic Dissent, include = F, cache = T}
tan_polex <- glmer(tan_rep ~ 
                     ln_polex_mem + 
                     intrastate + 
                     ln_gdp_pc +
                     totpop10k + 
                     urbanpop10k + 
                     lnt +
                     lnt2 + 
                     lnt3 + 
                     (1 | cowcode), 
                   family = binomial,
                   data = analysis_final)
```

```{r Tangible Repression Mass Expression, include = F, cache = T}
tan_massex <- glmer(tan_rep ~ 
                     ln_massex_mem + 
                     intrastate + 
                     ln_gdp_pc +
                     totpop10k + 
                     urbanpop10k + 
                     lnt +
                     lnt2 + 
                     lnt3 + 
                     (1 | cowcode), 
                   family = binomial,
                   data = analysis_final)
```

```{r Tangible Repression Political Violence, include = F, cache = T}
tan_polvio <- glmer(tan_rep ~ 
                     ln_polvio_mem + 
                     intrastate + 
                     ln_gdp_pc +
                     totpop10k + 
                     urbanpop10k + 
                     lnt +
                     lnt2 + 
                     lnt3 + 
                     (1 | cowcode), 
                   family = binomial,
                   data = analysis_final)
```

```{r Violent Repression Symbolic Dissent, include = F, cache = T}
vio_polex <- glmer(vio_rep ~ 
                     ln_polex_mem + 
                     intrastate + 
                     ln_gdp_pc +
                     totpop10k + 
                     urbanpop10k + 
                     lnt +
                     lnt2 + 
                     lnt3 + 
                     (1 | cowcode), 
                   family = binomial,
                   data = analysis_final)
```

```{r Violent Repression Mass Expression, include = F, cache = T}
vio_massex <- glmer(vio_rep ~ 
                     ln_massex_mem + 
                     intrastate + 
                     ln_gdp_pc +
                     totpop10k + 
                     urbanpop10k + 
                     lnt +
                     lnt2 + 
                     lnt3 + 
                     (1 | cowcode), 
                   family = binomial,
                   data = analysis_final)
```

```{r Violent Repression Political Violence, include = F, cache = T}
vio_polvio <- glmer(vio_rep ~ 
                     ln_polvio_mem + 
                     intrastate + 
                     ln_gdp_pc +
                     totpop10k + 
                     urbanpop10k + 
                     lnt +
                     lnt2 + 
                     lnt3 + 
                     (1 | cowcode), 
                   family = binomial,
                   data = analysis_final)
```

```{r Intangible Repression Coefplot Code, include = F, cache = T}

#make a data.frame of the coefficients to allow me more control over the coefficient plots
coef_int_polex <- broom::tidy(int_polex) %>% 
                  na.omit(estimate) %>% #removes SD of intercept
                  mutate(model = "Political Expression")

coef_int_massex <- broom::tidy(int_massex) %>% 
                  na.omit(estimate) %>% #removes SD of intercept
                  mutate(model = "Mass Expression")

coef_int_polvio <- broom::tidy(int_polvio) %>% 
                  na.omit(estimate) %>% #removes SD of intercept
                  mutate(model = "Political Violence")

int_rep <- rbind(coef_int_polex, coef_int_massex, coef_int_polvio) %>% 
           filter(term != "(Intercept)")

coef_int <- rbind(coef_int_polex, coef_int_massex, coef_int_polvio) %>% 
            filter(term == "ln_polex_mem" |
                   term == "ln_massex_mem" |
                   term == "ln_polvio_mem")

intangible_repression <- dwplot(coef_int,
       vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2)) %>% 
       relabel_predictors(ln_polex_mem = "Symbolic Dissent Memory",
                          ln_massex_mem = "Mass Dissent Memory",
                          ln_polvio_mem = "Political Violence Memory") + 
       labs(title = "Figure 1: Intangible Repression and Dissent Memory",
            x = "Random Effects Logit Coefficient",
            caption = "N = 21,006 for all models. Coefficient plots for all variables are in the appendix.")+
       theme(plot.title = element_text(hjust = 0.5),
             axis.text.y = element_text(angle = 45))



intangible_repression_all <- dwplot(int_rep,
                                    vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2)) %>% 
                             relabel_predictors(ln_polex_mem = "Political Expression",
                                                  ln_massex_mem = "Mass Expression",
                                                  ln_polvio_mem = "Political Violence", 
                                                  intrastate = "Civil War", 
                                                  ln_gdp_pc = "Logged GDP Per Capita",
                                                  totpop10k = "Total Population / 10k",
                                                  urbanpop10k = "Urban Population / 10k",
                                                  lnt = "T"
                                                ) +
                             labs(title = "Figure A1: Intangible Repression and Memory of Dissent with Controls",
                                  x = "Random Effects Logit Coefficients",
                                  caption = "N = 21,006 for all models.") +
                   theme(plot.title = element_text(hjust = 0.5, size = 11),
                         plot.caption = element_text(hjust = 0.5))
```

```{r Tangible Repression Coefplot Code, cache = T, include = F}
#make a dataframe of the estimates to allow me more control over the coefplot
coef_tan_polex <- broom::tidy(tan_polex) %>% 
                  na.omit(estimate) %>% #removes SD of intercept
                  mutate(model = "Political Expression")

coef_tan_massex <- broom::tidy(tan_massex) %>% 
                  na.omit(estimate) %>% #removes SD of intercept
                  mutate(model = "Mass Expression")

coef_tan_polvio <- broom::tidy(tan_polvio) %>% 
                  na.omit(estimate) %>% #removes SD of intercept
                  mutate(model = "Political Violence")

tan_rep <- rbind(coef_tan_polex, coef_tan_massex, coef_tan_polvio) %>% 
           filter(term != "(Intercept)")

coef_tan <- rbind(coef_tan_polex, coef_tan_massex, coef_tan_polvio) %>% 
            filter(term == "ln_polex_mem" |
                   term == "ln_massex_mem" |
                   term == "ln_polvio_mem")

tangible_repression <- dwplot(coef_tan,
       vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2)) %>% 
       relabel_predictors(ln_polex_mem = "Symbolic Dissent Memory",
                          ln_massex_mem = "Mass Dissent Memory",
                          ln_polvio_mem = "Political Violence Memory") + 
       labs(title = "Figure 2: Tangible Repression and Dissent Memory",
            x = "Random Effects Logit Coefficient",
            caption = "N = 21,006 for all models. Coefficient plots for all variables are in the appendix.")+
       theme(plot.title = element_text(hjust = 0.5),
             axis.text.y = element_text(angle = 45))



tangible_repression_all <- dwplot(tan_rep,
                                    vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2)) %>% 
                             relabel_predictors(ln_polex_mem = "Political Expression",
                                                  ln_massex_mem = "Mass Expression",
                                                  ln_polvio_mem = "Political Violence", 
                                                  intrastate = "Civil War", 
                                                  ln_gdp_pc = "Logged GDP Per Capita",
                                                  totpop10k = "Total Population / 10k",
                                                  urbanpop10k = "Urban Population / 10k",
                                                  lnt = "T"
                                                ) +
                             labs(title = "Figure A2: Tangible Repression and Memory of Dissent with Controls",
                                  x = "Random Effects Logit Coefficients",
                                  caption = "N = 21,006 for all models.") +
                   theme(plot.title = element_text(hjust = 0.5, size = 11),
                         plot.caption = element_text(hjust = 0.5))
```

```{r Violent Repression Coefplot Code, cache = T, include = F}
coef_vio_polex <- broom::tidy(vio_polex) %>% 
                  na.omit(estimate) %>% #removes SD of intercept
                  mutate(model = "Poltical Expression")

coef_vio_massex <- broom::tidy(vio_massex) %>% 
                  na.omit(estimate) %>% #removes SD of intercept
                  mutate(model = "Mass Expression")

coef_vio_polvio <- broom::tidy(vio_polvio) %>% 
                  na.omit(estimate) %>% #removes SD of intercept
                  mutate(model = "Political Violence")

vio_rep <- rbind(coef_vio_polex, coef_vio_massex, coef_vio_polvio) %>% 
           filter(term != "(Intercept)")

coef_vio <- rbind(coef_vio_polex, coef_vio_massex, coef_vio_polvio) %>% 
            filter(term == "ln_polex_mem" |
                   term == "ln_massex_mem" |
                   term == "ln_polvio_mem")

violent_repression <- dwplot(coef_vio,
       vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2)) %>% 
       relabel_predictors(ln_polex_mem = "Symbolic Dissent Memory",
                          ln_massex_mem = "Mass Dissent Memory",
                          ln_polvio_mem = "Political Violence Memory") + 
       labs(title = "Figure 3: Violent Repression and Dissent Memory",
            x = "Random Effects Logit Coefficient",
            caption = "N = 21,006 for all models. Coefficient plots for all variables are in the appendix.")+
       theme(plot.title = element_text(hjust = 0.5),
             axis.text.y = element_text(angle = 45))



violent_repression_all <- dwplot(vio_rep,
                                    vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2)) %>% 
                             relabel_predictors(ln_polex_mem = "Political Expression",
                                                  ln_massex_mem = "Mass Expression",
                                                  ln_polvio_mem = "Political Violence", 
                                                  intrastate = "Civil War", 
                                                  ln_gdp_pc = "Logged GDP Per Capita",
                                                  totpop10k = "Total Population / 10k",
                                                  urbanpop10k = "Urban Population / 10k",
                                                  lnt = "T"
                                                ) +
                             labs(title = "Figure A3: Violent Repression and Memory of Dissent with Controls",
                                  x = "Random Effects Logit Coefficients",
                                  caption = "N = 21,006 for all models.") +
                   theme(plot.title = element_text(hjust = 0.5, size = 11),
                         plot.caption = element_text(hjust = 0.5))
```

  Each model has 21,006 observations with 85 panels. The coefficients of interest are plotted below and the full coefficient plots including controls and the standard deviation of the intercept is in the appendix. Note that each coefficient in the coefficient plot below corresponds to one variable in one model. Because the three measurements of dissent are all highly correlated (greater than 0.5 in all cases) I estimate each variable in its own model. In a robustness check I include them all in the same model and the results remain about the same.  
  
  Figure one shows the results of the three mixed effect logits with intangible repression as the dependent variable. The results are a mixed bag of pessimism and optimism for democratic governance. On the pessimistic side of things the memory of symbolic dissent increases the probability of intangible repression occuring. This suggests that democratic leaders are meeting the symbolic dissent, an intangible avenue of dissenting, with intangible repression. It is unexpected that democracies would repress in this way because the civil liberties (freedom of association, religion, press, etc.) that are infringed upon by intangible repression are central to the democratic idea of governance. Nonetheless, in full electoral democracies the results suggest that exercising these civil liberties increases the probability that they will be cracked down on.  
  
  The optimist story of figure one has two faces: mass expression does not make intangible repression more likely, and political violence decreases the probability of intangible repression. In many ways it makes sense that mass dissent does not beget intangible repression. First, nonviolent protest is a primary protected civil right in democracies. Second, mass dissent events are extremely visible to the public and to the media. Because these events are so visible they are a costly event to react to for a government because not only will it affect many people, but many people will know about that effect and they will remember these repressive responses come election time.  Thus, it is in the best interest of the state to not respond to these events.    
  
  Political violence decreases the probability of intangible repression. This finding is perplexing but also normatively optimistic. If a state is ever legitimized in the use of force, it is during heightened times of political violence because security is most threatened then. Intangible repression should be the first step taken to dissuade dissent in the future. It is likely that states simply find this type of repression to be ineffective and thus unattractive as a policy tool. 
  
```{r Intangible Repression Coefplot, cache = T, include = T}
intangible_repression
```  
  
  Figure 2 shows the results of the tangible repression models. These models have much more pessimistic inferences. Both symbolic dissent and political violence memory associate with an increase the probability of tangible repression. The relationship between symbolic dissent and tangible repression is particularly troubling. The results suggest that as symbolic dissent, the most protected civil liberties in democracies, increases tangible repression such as extrajudicial arrests, abuse of police power are also more common. This is quite a malicious form of governance. 
  
  Political violence positively associating with tangible repression fits the theoretical expectation that states will take steps toward creating security in lieu of protecting civil liberties. This is legitimized because non-state actors created a threat to security, and one effective strategy for removing the threat to the state. Tangible repression is also a relatively tempered response to political violence given that it refrains from causing death as much as possible. 
  
  Mass expression is not associated with any change in the probability of tangible repression. This is likely because of the same mechanism discussed above: visibility. Mass expressions in democracies are explicitly protected legally, very visible, and thus politically costly to respond to with repression. 
  
```{r Tangible Repression Coefplot, cache = T, include = T}
tangible_repression
```  
  
  Figure 3 below shows the results of the violent repression models. They provide a much more optimistic view of democratic governance as a response to dissent. Symbolic dissent is not associated with violent repression, which is expected. Mass expression and political violence are both negatively associated with violent repression, which bodes well for democratic governance.  
  
  It is difficult if ever possible to legitimize the use of violent repression in democracies. The democratic form of governance has an explicity promise to use nonviolent policy tools to solve grievances of the population. It also has no precedent for using violence on its own people. Even in the scenario that mass dissent is extraordinarily high or political violence is sufficiently common one should not see violent repression become commonplace. In democracies, this is a policy tool that should never be used according to the electoral incentives democratic leaders face. Using violence on citizens is likely to result in a loss of public support. 

```{r Violent Repression Coefplot, cache = T, include = T}
violent_repression
```  

## Conclusion  
  
  In this paper I ask when democracies repress. While most of the literature argues that democracies do not repress as much as other regime types, I ask when full electoral democracies actually do repress. This is an untouched portion of the literature that offers fruitful inferences for future research to build on. Moreover, I use events data aggregated to the country-month unit of analysis to give more leverage to modeling the variation in repression within a year. I also look at more three types of repression (intangible, tangible, and violent) and three types of dissent (symbolic, mass, and violent). Both of these expansions of what it means to dissent and to repress are further improvements on the existing literature. 
  
  I find that symbolic dissent makes intangible and tangible repression more likely. This is rather a pessimistic finding for democratic governance because symbolic dissent is generally explicitly protected by democracies. I also find that mass expression has no relationship with intangible or tangible dissent, but is negatively associated with the probability of violent repression ocurring. This is likely because mass expression events such as mass protests are particularly visible and nonviolent and thus costly targets for repression when leaders face upcoming reelection. Violent dissent makes intangible and violent repression less likely, but tangible repression more likely. Political violence is not effectively counteracted with intangible dissent, and not legitimately addressed with violent repression because violent is never in the domestic policy toolkit of elected officials. However, using tangible repression is the most direct way to address political violence without actually being violent.  
  
# Appendix 
```{r Appendix Coefplots 1, cache = T, include = T}
intangible_repression_all
```

```{r Appendix Coefplots2, cache = T, include = T}
tangible_repression_all
```

```{r Appendix Coefplots3, cache = T, include = T}
violent_repression_all
```
